# 有給管理システム データ移行プロジェクト

## プロジェクト概要
エクセルデータ配下の有給管理ファイルをスプレッドシートに移行する暫定システム構築

## 完了した作業

### 1. データ分析 ✅
- 4つの事業所（ライズ、パロン、シエル、EBISU）
- 合計153名の有給データファイル分析完了
- 退職者フォルダは移行対象外として確認

### 2. 移行方針決定 ✅
**利用者番号採番ルール:**
- ライズ: R + 2桁番号（R01-R09）
- パロン: P + 2桁番号（P01-P51、欠番あり）
- シエル: S + 2桁番号（S01-S51）
- EBISU: E + 2桁番号（E01-E45）

**データ項目:**
- 利用者番号：事業所コード + ファイル番号
- 利用者名：Excelファイル名から抽出
- 残有給日数：管理簿タブのJ列最下行
- 備考：空欄

### 3. データ移行実行 ✅
**移行スクリプト:** `migrate_data.py`
- Python環境セットアップ完了（pandas, openpyxl）
- 各ExcelファイルからJ列データ抽出機能実装
- 管理簿タブ自動検出機能付き

**移行結果:**
- ライズ: 9名（多くが0日、1名のみ24日）
- パロン: 48名（8-40日の幅広い分布）
- シエル: 51名（前半34日、後半10-25日）
- EBISU: 45名（0-21日の分布）

**出力ファイル:** `有給管理_移行データ.csv`

## 次回作業時の継続ポイント

### すぐに使用可能なファイル
1. `migrate_data.py` - データ移行スクリプト
2. `有給管理_移行データ.csv` - 完成したCSVデータ（153名分）

### 次のステップ候補
1. GoogleスプレッドシートへのCSVインポート手順作成
2. 管理者向けメンテナンス機能追加
3. データ検証・チェック機能の実装
4. 定期更新スクリプトの作成

### 重要な技術情報
- Python環境: pandas, openpyxl インストール済み
- Excelファイル構造: 管理簿タブのJ列に残日数格納
- ファイル命名規則: `[番号].[氏名].xlsx`

## ディレクトリ構造
```
yukyu-kanri-new/
├── エクセルデータ/
│   ├── EBISU/ (45名)
│   ├── シエル/ (51名 + 退職者6名)
│   ├── パロン/ (48名 + 退職者9名)
│   └── ライズ/ (9名)
├── migrate_data.py
├── 有給管理_移行データ.csv
└── CLAUDE.md (このファイル)
```

## 実行コマンド
```bash
# データ移行実行
python3 migrate_data.py

# 結果確認
head -20 有給管理_移行データ.csv
```